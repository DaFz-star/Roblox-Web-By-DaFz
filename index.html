<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roblox Hub Share By DaFz</title>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        @keyframes rgbBorder { 0% { border-color:#ff0000; } 16% { border-color:#ff9900; } 32% { border-color:#ffff00; } 48% { border-color:#00ff00; } 64% { border-color:#0099ff; } 80% { border-color:#9900ff; } 100% { border-color:#ff0000; } }
        @keyframes rgbGlow { 0% { box-shadow:0 0 20px #ff0000; } 16% { box-shadow:0 0 20px #ff9900; } 32% { box-shadow:0 0 20px #ffff00; } 48% { box-shadow:0 0 20px #00ff00; } 64% { box-shadow:0 0 20px #0099ff; } 80% { box-shadow:0 0 20px #9900ff; } 100% { box-shadow:0 0 20px #ff0000; } }
        body { font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif; background:#000; min-height:100vh; color:#fff; }
        .container { max-width:1400px; margin:0 auto; padding:20px; }
        .login-screen { display:flex; justify-content:center; align-items:center; min-height:100vh; padding:20px; }
        .login-box { background:#1a1a1a; padding:40px; border-radius:20px; border:3px solid #ff0000; animation:rgbBorder 3s linear infinite, rgbGlow 3s linear infinite; max-width:450px; width:100%; }
        .login-box h1 { text-align:center; color:#fff; margin-bottom:30px; font-size:24px; }
        .form-group { margin-bottom:20px; }
        .form-group label { display:block; margin-bottom:8px; color:#fff; font-weight:500; }
        .form-group input { width:100%; padding:12px 15px; border:2px solid #333; border-radius:10px; font-size:14px; outline:none; background:#2a2a2a; color:#fff; }
        .form-group input:focus { border-color:#ff0000; }
        .btn { width:100%; padding:14px; border:none; border-radius:10px; font-size:16px; font-weight:bold; cursor:pointer; transition:all 0.3s; margin-bottom:10px; }
        .btn:hover { transform:translateY(-2px); }
        .btn-primary { background:#ff0000; color:white; animation:rgbGlow 3s linear infinite; }
        .btn-secondary { background:#2a2a2a; color:#fff; border:2px solid #333; }
        .btn-danger { background:#e74c3c; color:white; }
        .main-app { display:none; }
        header { background:#1a1a1a; padding:20px; border-radius:15px; margin-bottom:20px; border:2px solid #ff0000; animation:rgbBorder 3s linear infinite; }
        .user-info { display:flex; align-items:center; gap:15px; margin-bottom:15px; }
        .user-avatar { width:50px; height:50px; border-radius:50%; background:#ff0000; animation:rgbGlow 3s linear infinite; display:flex; align-items:center; justify-content:center; color:white; font-size:20px; font-weight:bold; }
        .logout-btn { padding:10px 20px; background:#e74c3c; color:white; border:none; border-radius:25px; cursor:pointer; font-weight:bold; margin-top:10px; }
        .admin-section { background:#1a1a1a; border-radius:15px; padding:20px; margin-bottom:20px; border:2px solid #ff0000; animation:rgbBorder 3s linear infinite; display:none; }
        .user-list-item { background:#2a2a2a; padding:12px; margin-bottom:10px; border-radius:8px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; gap:10px; }
        .user-list-item:hover { background:#333; }
        .ban-info { color:#e74c3c; font-size:12px; margin-top:5px; }
        .id-section, .friends-section, .main-content .section { background:#1a1a1a; border-radius:15px; padding:20px; margin-bottom:20px; border:2px solid #ff0000; animation:rgbBorder 3s linear infinite; }
        .id-item { background:#2a2a2a; padding:12px; margin-bottom:10px; border-radius:8px; display:flex; justify-content:space-between; align-items:center; }
        .scripts-list { max-height:500px; overflow-y:auto; }
        .script-item { background:#2a2a2a; padding:15px; margin-bottom:15px; border-radius:10px; border-left:4px solid #e74c3c; cursor:pointer; transition:all 0.3s; }
        .script-item:hover { transform:translateX(5px); border-left-width:6px; }
        .script-item.expanded { background:#333; }
        .script-preview { display:block; }
        .script-full { display:none; }
        .script-item.expanded .script-preview { display:none; }
        .script-item.expanded .script-full { display:block; }
        .script-code { background:#000; color:#00ff00; padding:10px; border-radius:5px; font-family:'Courier New',monospace; font-size:12px; overflow-x:auto; margin:10px 0; border:1px solid #333; white-space:pre-wrap; }
        .chat-button { position:fixed; bottom:30px; right:30px; width:70px; height:70px; border-radius:50%; background:#25D366; border:3px solid #fff; animation:rgbBorder 3s linear infinite, rgbGlow 3s linear infinite; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:35px; z-index:1000; }
        .chat-fullscreen { position:fixed; top:0; left:0; right:0; bottom:0; background:#000; z-index:2000; display:none; padding:20px; }
        .chat-fullscreen.active { display:flex; flex-direction:column; }
        .chat-container { max-width:800px; width:100%; margin:0 auto; display:flex; flex-direction:column; height:100%; }
        .chat-header { background:#25D366; animation:rgbGlow 3s linear infinite; color:white; padding:15px; border-radius:10px; margin-bottom:15px; font-weight:bold; display:flex; justify-content:space-between; align-items:center; }
        .chat-messages { flex:1; overflow-y:auto; padding:15px; background:#0a0a0a; border-radius:10px; margin-bottom:15px; border:2px solid #333; }
        .message { margin-bottom:15px; padding:10px 15px; border-radius:10px; max-width:70%; }
        .message.sent { background:#056162; margin-left:auto; text-align:right; }
        .message.received { background:#1f1f1f; }
        .message-sender { font-size:12px; font-weight:bold; color:#00ff00; margin-bottom:5px; }
        .message-time { font-size:11px; color:#888; margin-top:5px; }
        .chat-input-area { display:flex; gap:10px; }
        .chat-input-area input { flex:1; padding:12px; border:2px solid #333; border-radius:25px; outline:none; background:#2a2a2a; color:#fff; }
        .chat-input-area button { padding:12px 25px; background:#25D366; color:white; border:none; border-radius:25px; cursor:pointer; font-weight:bold; }
        ::-webkit-scrollbar { width:8px; }
        ::-webkit-scrollbar-track { background:#1a1a1a; }
        ::-webkit-scrollbar-thumb { background:#333; border-radius:4px; }
    </style>
</head>
<body onload="init()">

    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <h1>üéÆ Roblox Hub Share By DaFz</h1>
            <div class="form-group"><label>Username</label><input type="text" id="username" placeholder="Masukkan username"></div>
            <div class="form-group"><label>Password</label><input type="password" id="password" placeholder="Masukkan password"></div>
            <button class="btn btn-primary" onclick="loginUser()">üîì Login</button>
            <button class="btn btn-secondary" onclick="registerUser()">‚ú® Daftar Baru</button>
            <button class="btn btn-secondary" onclick="googleLogin()">üîµ Login Tamu</button>
            <div style="text-align:center;margin-top:20px;padding:10px;background:#2a2a2a;border-radius:8px;">
                <p style="color:#888;font-size:12px;">Tips: Username case-sensitive, minimal 4 karakter</p>
            </div>
        </div>
    </div>

    <div class="container main-app" id="mainApp">
        <header>
            <div class="user-info">
                <div class="user-avatar" id="avatar">U</div>
                <div>
                    <div id="userName" style="font-weight:bold;font-size:18px;">Username</div>
                    <div id="userEmail" style="color:#aaa;font-size:14px;">email@example.com</div>
                </div>
            </div>
            <div style="display:flex;gap:10px;flex-wrap:wrap;margin:15px 0;">
                <a href="https://www.roblox.com/users/search?keyword=rez_sukamakan" target="_blank" style="padding:10px 20px;background:#e74c3c;color:white;text-decoration:none;border-radius:25px;font-weight:bold;">üéÆ Roblox</a>
                <a href="https://www.tiktok.com/@dafz_bobox" target="_blank" style="padding:10px 20px;background:#000;color:white;text-decoration:none;border-radius:25px;font-weight:bold;border:2px solid #fff;">üì± TikTok</a>
                <a href="https://wa.me/6281215315308" target="_blank" style="padding:10px 20px;background:#25D366;color:white;text-decoration:none;border-radius:25px;font-weight:bold;">üí¨ WhatsApp</a>
            </div>
            <button class="logout-btn" onclick="logoutUser()">Logout</button>
        </header>

        <div class="admin-section" id="adminSection">
            <h2>üõ°Ô∏è Admin Panel - DaFz</h2>
            <p style="color:#aaa;">Kelola user: ban / unban / akses akun</p>
            <div id="userList"></div>
        </div>

        <div class="id-section">
            <h2>üéØ Model IDs (Studio Lite)</h2>
            <div class="id-edit-form">
                <input type="text" id="newModelId" placeholder="ID angka">
                <input type="text" id="modelCustomName" placeholder="Nama custom (opsional)">
                <button class="btn btn-primary" onclick="addModelId()">‚ûï Tambah ID</button>
            </div>
            <div class="id-list" id="myIdList"></div>
        </div>

        <div class="friends-section">
            <div class="section-header">üë• Teman</div>
            <div id="friendsList"></div>
            <div style="display:flex;gap:10px;margin-top:15px;">
                <input type="text" id="friendUsername" placeholder="Username teman" style="flex:1;padding:10px;border-radius:5px;border:1px solid #333;background:#2a2a2a;color:white;">
                <button class="btn-primary" onclick="addFriend()">Add</button>
            </div>
        </div>

        <div class="main-content">
            <div class="section">
                <div class="section-header">üì§ Upload Script</div>
                <div class="upload-area" id="uploadArea">Klik untuk upload .txt atau .lua</div>
                <input type="file" id="fileInput" accept=".txt,.lua" style="display:none;">
                <div class="form-group"><label>Nama Script</label><input type="text" id="scriptName" placeholder="Nama script"></div>
                <div class="form-group"><label>Keterangan</label><input type="text" id="scriptDesc" placeholder="Deskripsi singkat"></div>
                <button class="btn btn-primary" onclick="saveNewScript()">üíæ Simpan</button>
            </div>

            <div class="section">
                <div class="section-header">üìú Script Kamu</div>
                <div class="scripts-list" id="scriptsList"></div>
            </div>
        </div>

        <div class="chat-button" onclick="toggleChat(null)">üí¨</div>

        <div class="chat-fullscreen" id="chatWindow">
            <div class="chat-container">
                <div class="chat-header" id="chatHeader">
                    <span>üí¨ Chat</span>
                    <button style="background:#e74c3c;border:none;color:white;padding:8px 15px;border-radius:5px;cursor:pointer;font-weight:bold;" onclick="toggleChat(null)">‚úñ Tutup</button>
                </div>
                <div class="chat-messages" id="chatMessages"></div>
                <div class="chat-input-area">
                    <input type="text" id="chatInput" placeholder="Ketik pesan...">
                    <button onclick="sendChatMessage()">Kirim</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentUser = null;
        let scriptContent = '';
        let allChats = JSON.parse(localStorage.getItem('allChats') || '{}');
        let currentChatFriend = null;

        function init() {
            let users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
            if (!users.DaFz) {
                users.DaFz = {
                    password: 'AkunAdmin',
                    email: 'admin@dafz.com',
                    isAdmin: true,
                    modelIds: [],
                    scripts: [],
                    friends: [],
                    bannedUsers: {} // {username: {until: timestamp atau 'permanent'}}
                };
            }
            localStorage.setItem('robloxUsers', JSON.stringify(users));
            document.getElementById('username').focus();
            document.getElementById('uploadArea').onclick = () => document.getElementById('fileInput').click();
            document.getElementById('fileInput').onchange = e => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = ev => { scriptContent = ev.target.result; alert('File dibaca!'); };
                    reader.readAsText(file);
                }
            };
        }

        function isUserBanned(username) {
            const users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
            const admin = users.DaFz;
            if (!admin || !admin.bannedUsers) return false;
            const ban = admin.bannedUsers[username];
            if (!ban) return false;
            if (ban === 'permanent') return {banned: true, message: 'Akun kamu diban permanen oleh admin.'};
            const now = Date.now();
            if (now < ban.until) {
                const remaining = Math.ceil((ban.until - now) / 3600000); // jam
                return {banned: true, message: `Akun diban oleh admin. Sisa waktu: ${remaining} jam.`};
            }
            delete admin.bannedUsers[username];
            localStorage.setItem('robloxUsers', JSON.stringify(users));
            return false;
        }

        function loginUser() {
            const u = document.getElementById('username').value.trim();
            const p = document.getElementById('password').value;
            if (!u || !p) return alert('Isi username & password!');

            const users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
            if (!users[u]) return alert('Username tidak ditemukan!');
            if (users[u].password !== p) return alert('Password salah!');

            const banStatus = isUserBanned(u);
            if (banStatus.banned) return alert(banStatus.message);

            currentUser = { username: u, ...users[u] };
            showApp();
        }

        function registerUser() {
            const u = document.getElementById('username').value.trim();
            const p = document.getElementById('password').value;
            if (!u || !p) return alert('Isi semua!');
            if (u.length < 4) return alert('Username minimal 4 karakter!');
            if (p.length < 6) return alert('Password minimal 6 karakter!');
            const users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
            if (users[u]) return alert('Username sudah ada! (case-sensitive)');
            users[u] = {
                password: p,
                email: u + '@ex.com',
                modelIds: [],
                scripts: [],
                friends: []
            };
            localStorage.setItem('robloxUsers', JSON.stringify(users));
            currentUser = { username: u, ...users[u] };
            alert('Daftar berhasil!');
            showApp();
        }

        function googleLogin() {
            const rand = Math.floor(Math.random() * 10000);
            const u = 'guest_' + rand;
            const users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
            if (users[u]) return googleLogin();
            users[u] = {
                password: 'guest' + rand,
                email: 'guest' + rand + '@ex.com',
                modelIds: [],
                scripts: [],
                friends: []
            };
            localStorage.setItem('robloxUsers', JSON.stringify(users));
            currentUser = { username: u, ...users[u] };
            alert('Login tamu berhasil!');
            showApp();
        }

        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('userName').textContent = currentUser.username;
            document.getElementById('userEmail').textContent = currentUser.email;
            document.getElementById('avatar').textContent = currentUser.username[0].toUpperCase();

            if (currentUser.isAdmin) {
                document.getElementById('adminSection').style.display = 'block';
                renderAdminUsers();
                // Hapus semua akun selain admin saat admin login
                const users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
                const adminData = users['DaFz'];
                const cleaned = { 'DaFz': adminData };
                localStorage.setItem('robloxUsers', JSON.stringify(cleaned));
                renderAdminUsers(); // refresh list (sekarang kosong kecuali admin)
            }

            renderMyIds();
            renderScriptsList();
            renderFriendsList();
        }

        function renderAdminUsers() {
            const cont = document.getElementById('userList');
            cont.innerHTML = '<p style="color:#aaa;">Semua user selain admin sudah dihapus otomatis.</p><p style="color:#0f0;">Gunakan fitur ban jika ingin blokir user tertentu.</p>';
            // Karena sudah dihapus, list kosong. Jika mau restore manual, bisa ditambah fitur import user nanti.
        }

        function banUser(username, durationHours = null) {
            const users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
            if (!users.DaFz) return;
            users.DaFz.bannedUsers = users.DaFz.bannedUsers || {};
            if (durationHours === null) {
                users.DaFz.bannedUsers[username] = 'permanent';
                alert(`${username} diban permanen!`);
            } else {
                const until = Date.now() + (durationHours * 3600 * 1000);
                users.DaFz.bannedUsers[username] = {until};
                alert(`${username} diban selama ${durationHours} jam!`);
            }
            localStorage.setItem('robloxUsers', JSON.stringify(users));
        }

        function unbanUser(username) {
            const users = JSON.parse(localStorage.getItem('robloxUsers') || '{}');
            if (users.DaFz && users.DaFz.bannedUsers && users.DaFz.bannedUsers[username]) {
                delete users.DaFz.bannedUsers[username];
                localStorage.setItem('robloxUsers', JSON.stringify(users));
                alert(`${username} sudah di-unban!`);
            }
        }

        // Fungsi lain (addModelId, saveNewScript, renderMyIds, renderScriptsList, dll) tetap sama seperti versi sebelumnya
        // ... (saya tidak ulang semua agar tidak terlalu panjang, copy dari kode lama kamu jika perlu)

        function logoutUser() {
            currentUser = null;
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('loginScreen').style.display = 'flex';
        }

        init();
    </script>
</body>
</html>